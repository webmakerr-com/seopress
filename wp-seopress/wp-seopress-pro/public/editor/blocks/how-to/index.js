(()=>{"use strict";const e=window.wp.i18n,t=window.wp.blocks,s=window.React,o=window.wp.data,r=e=>{let t=document.createElement("div");return t.innerHTML=e,t.textContent||t.innerText||""},n=(t=0,s=0,o=0,r="display")=>{let n="",a="",i="",l="";if(t=parseInt(t)?parseInt(t):0,s=parseInt(s)?parseInt(s):0,o=parseInt(o)?parseInt(o):0,"schema"===r)a=t?`${t}D`:"",i=s?`${s}H`:"",l=o?`${o}M`:"",n=`${t>0||s>0||o>0?"P":""}${a}${s>0||o>0?"T":""}${i}${l}`;else{
/* translators: %1$s: number of days */
a=t>0?(0,e.sprintf)((0,e._n)("%1$s day","%1$s days",t,"wp-seopress-pro"),t):"",
/* translators: %1$s: number of hours */
i=s>0?(0,e.sprintf)((0,e._n)("%1$s hour","%1$s hours",s,"wp-seopress-pro"),s):"",
/* translators: %1$s: number of minutes */
l=o>0?(0,e.sprintf)((0,e._n)("%1$s minute","%1$s minutes",o,"wp-seopress-pro"),o):"";const r=[a,i,l].filter((e=>""!==e));n=r.length?r.join(", "):""}return n},a=window.wp.url,i=window.wp.blockEditor,l=JSON.parse('{"UU":"wpseopress/how-to-step"}');(0,t.registerBlockType)(l.UU,{title:(0,e.__)("How To Step","wp-seopress-pro"),description:(0,e.__)("Display a tutorial step.","wp-seopress-pro"),edit:function({attributes:t,setAttributes:n}){let{title:l,description:c,schema:p}=t;const d=(e,t)=>{const s={...p,"@type":"HowToStep"};switch(e){case"title":s.name=t,s.url=(0,o.select)("core/editor").getPermalink()+"#"+(0,a.cleanForSlug)(t);break;case"description":s.text=r(t);const e=t.match(/src="(.*?)"/);e&&e[1]&&(s.image=e[1])}n({schema:s,[e]:t})};return(0,s.createElement)("li",{...(0,i.useBlockProps)()},(0,s.createElement)(i.RichText,{tagName:"strong",value:l,className:"wpseopress-how-to-step-title",onChange:e=>d("title",e),placeholder:(0,e.__)("Type a title","wp-seopress-pro")}),(0,s.createElement)(i.RichText,{tagName:"div",value:c,multiline:!0,className:"wpseopress-how-to-step-description",onChange:e=>d("description",e),placeholder:(0,e.__)("Type a description","wp-seopress-pro")}))},save:function({attributes:e}){const{title:t,description:o}=e;return(0,s.createElement)("li",{...i.useBlockProps.save()},t&&(0,s.createElement)(i.RichText.Content,{tagName:"strong",id:(0,a.cleanForSlug)(t),value:t,className:"wpseopress-how-to-step-title"}),(0,s.createElement)(i.RichText.Content,{tagName:"div",value:o,className:"wpseopress-how-to-step-description"}))}});const c=window.wp.components,p=({attributes:t,updateField:o})=>{const{durationDays:r,durationHours:n,durationMinutes:a,estimatedCost:l,unorderedList:p}=t;return(0,s.createElement)(i.InspectorControls,null,(0,s.createElement)(c.PanelBody,{title:(0,e.__)("Block settings","wp-seopress-pro")},(0,s.createElement)(c.PanelRow,null,(0,s.createElement)(c.CheckboxControl,{label:(0,e.__)("Display as unordered list.","wp-seopress-pro"),checked:p,onChange:e=>o("unorderedList",e)})),(0,s.createElement)(c.PanelRow,null,(0,s.createElement)(c.TextControl,{label:(0,e.__)("Estimated cost","wp-seopress-pro"),value:l,onChange:e=>o("estimatedCost",e)})),(0,s.createElement)(c.PanelRow,{className:"totalTime-controls"},(0,s.createElement)(c.TextControl,{type:"number",min:"0",label:(0,e.__)("Days","wp-seopress-pro"),value:r,onChange:e=>o("durationDays",e)}),(0,s.createElement)(c.TextControl,{type:"number",min:"0",label:(0,e.__)("Hours","wp-seopress-pro"),value:n,onChange:e=>o("durationHours",e)}),(0,s.createElement)(c.TextControl,{type:"number",min:"0",label:(0,e.__)("Minutes","wp-seopress-pro"),value:a,onChange:e=>o("durationMinutes",e)}))))},d=t=>(0,s.createElement)(i.Inserter,{rootClientId:t.clientId,renderToggle:({onToggle:t,disabled:o})=>(0,s.createElement)(c.Button,{className:"add-step-button",onClick:t,disabled:o,text:(0,e.__)("Add step","wp-seopress-pro"),icon:"insert"}),isAppender:!0}),u=({estimatedCost:t})=>t?(0,s.createElement)("p",{className:"wpseopress-how-to-estimated-cost"},(0,e.sprintf)((0,e.__)("Estimated cost: %1$s","wp-seopress-pro"),t)):"",m=({durationDays:t,durationHours:o,durationMinutes:r})=>{const a=n(t,o,r,"display");return a?(0,s.createElement)("p",{className:"wpseopress-how-to-total-time"},(0,e.sprintf)("Total time: %1$s",a)):""},w=JSON.parse('{"UU":"wpseopress/how-to"}');(0,t.registerBlockType)(w.UU,{title:(0,e.__)("How to","wp-seopress-pro"),description:(0,e.__)("Display a tutorial block.","wp-seopress-pro"),keywords:[(0,e.__)("How to","wp-seopress-pro"),(0,e.__)("Tutorial","wp-seopress-pro")],edit:function({attributes:t,setAttributes:a,clientId:l}){const{description:c,schema:w,durationDays:h,durationHours:g,durationMinutes:E,unorderedList:_,estimatedCost:b}=t,T=(e,t="")=>{const s={...w,"@context":"https://schema.org","@type":"HowTo",name:(0,o.select)("core/editor").getEditedPostAttribute("title")},i=(0,o.select)("core/editor").getEditedPostAttribute("featured_media");if(i){const e=(0,o.select)("core").getMedia(i),t=e&&e.source_url?e.source_url:"";delete s.image,t&&(s.image=t)}switch(e){case"description":s.description=r(t),""===s.description&&delete s.description;break;case"durationDays":s.totalTime=n(t,g,E,"schema"),s.totalTime||delete s.totalTime;break;case"durationHours":s.totalTime=n(h,t,E,"schema"),s.totalTime||delete s.totalTime;break;case"durationMinutes":s.totalTime=n(h,g,t,"schema"),s.totalTime||delete s.totalTime;break;case"estimatedCost":s.estimatedCost=t,s.estimatedCost||delete s.estimatedCost}a({schema:s,[e]:t})},y=()=>{const e=(0,o.select)("core/block-editor").getBlock(l).innerBlocks||[];let t=[];return e.length&&(t=e.reduce(((e,t)=>(void 0!==t.attributes.schema&&e.push(t.attributes.schema),e)),[])),t},C=(0,o.subscribe)((e=>{const t=(0,o.select)("core/editor").isSavingPost();if((0,o.select)("core/editor").isAutosavingPost()||t)return;const s=(0,o.select)("core/block-editor").isBlockSelected(l),r=(0,o.select)("core/block-editor").hasSelectedInnerBlock(l);(s||r)&&(C(),(()=>{C();const e={...w,"@context":"https://schema.org","@type":"HowTo",name:(0,o.select)("core/editor").getEditedPostAttribute("title"),step:y()};JSON.stringify(w.step)!==JSON.stringify(e.step)&&(C(),a({schema:e}))})())})),k=_?"ul":"ol";return(0,s.createElement)("div",{...(0,i.useBlockProps)()},(0,s.createElement)(p,{attributes:t,updateField:T}),(0,s.createElement)(i.RichText,{tagName:"div",value:c,multiline:!0,className:"wpseopress-how-to-description",onChange:e=>T("description",e),placeholder:(0,e.__)("Type in a tutorial description or introduction","wp-seopress-pro")}),(0,s.createElement)(u,{estimatedCost:b}),(0,s.createElement)(m,{durationDays:h,durationHours:g,durationMinutes:E}),(0,s.createElement)(k,{className:"wpseopress-how-to-steps"},(0,s.createElement)(i.InnerBlocks,{allowedBlocks:["wpseopress/how-to-step"],renderAppender:()=>(0,s.createElement)(d,{clientId:l})})))},save:function({attributes:e}){const{description:t,schema:o,unorderedList:r,durationDays:n,durationHours:a,durationMinutes:l,estimatedCost:c}=e,p=r?"ul":"ol";return(0,s.createElement)("div",{...i.useBlockProps.save()},t&&(0,s.createElement)(i.RichText.Content,{tagName:"div",value:t,className:"wpseopress-how-to-description"}),(0,s.createElement)(u,{estimatedCost:c}),(0,s.createElement)(m,{durationDays:n,durationHours:a,durationMinutes:l}),(0,s.createElement)(p,{className:"wpseopress-how-to-steps"},(0,s.createElement)(i.InnerBlocks.Content,null)),(0,s.createElement)("script",{type:"application/ld+json"},JSON.stringify(o)))}})})();